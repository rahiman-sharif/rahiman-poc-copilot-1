<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <div class="header-content">
            <div class="logo-section">
                <h1><i class="fas fa-building"></i> Company Settings</h1>
                <p>Configure Company Information</p>
            </div>
            <div class="user-section">
                <div class="user-info">
                    <div class="user-name"><%= user.fullName %></div>
                    <div class="user-role"><%= user.role %></div>
                </div>
                <a href="/logout" class="logout-btn">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </div>
        </div>
    </header>

    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/dashboard"><i class="fas fa-home"></i> Dashboard</a>
            <span class="separator">/</span>
            <a href="/settings">Settings</a>
            <span class="separator">/</span>
            <span class="current">Company Settings</span>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="items-main">
        <!-- Page Header -->
        <div class="page-header">
            <div class="header-left">
                <h2><i class="fas fa-building"></i> Company Settings</h2>
                <p>Configure your company information and branding</p>
            </div>
            <div class="header-right">
                <a href="/settings" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Back to Settings
                </a>
            </div>
        </div>

        <!-- Alert Messages -->
        <% if (typeof message !== 'undefined' && message) { %>
            <div class="alert alert-<%= message.type %>">
                <i class="fas fa-<%= message.type === 'success' ? 'check-circle' : 'exclamation-triangle' %>"></i>
                <%= message.text %>
            </div>
        <% } %>

        <% if (typeof success !== 'undefined' && success) { %>
            <div class="alert alert-success">
                <i class="fas fa-check-circle"></i>
                <%= success %>
            </div>
        <% } %>

        <% if (typeof error !== 'undefined' && error) { %>
            <div class="alert alert-error">
                <i class="fas fa-exclamation-triangle"></i>
                <%= error %>
            </div>
        <% } %>

        <!-- Company Settings Form -->
        <div class="form-container">
            <form action="/settings/company" method="POST" class="form-card">
                <!-- Basic Information -->
                <div class="form-section">
                    <h3><i class="fas fa-info-circle"></i> Basic Information</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="companyName">Company Name *</label>
                            <input type="text" id="companyName" name="companyName" 
                                   value="<%= company ? company.name : companyName %>" 
                                   required>
                            <small class="form-help">Your company's legal business name</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <input type="email" id="email" name="email" 
                                   value="<%= company && company.contact ? company.contact.email : 'info@vikramsteels.com' %>">
                            <small class="form-help">Primary contact email</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="phone1">Primary Phone Number</label>
                            <input type="tel" id="phone1" name="phone1" 
                                   value="<%= company && company.contact ? company.contact.phone1 : '+91 98765 43210' %>">
                            <small class="form-help">Primary contact number</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="phone2">Secondary Phone Number</label>
                            <input type="tel" id="phone2" name="phone2" 
                                   value="<%= company && company.contact ? company.contact.phone2 : '' %>">
                            <small class="form-help">Secondary contact number (optional)</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="website">Website</label>
                            <input type="url" id="website" name="website" 
                                   value="<%= company && company.contact ? company.contact.website : '' %>" 
                                   placeholder="https://www.vikramsteels.com">
                            <small class="form-help">Company website URL</small>
                        </div>
                    </div>
                </div>

                <!-- Address Information -->
                <div class="form-section">
                    <h3><i class="fas fa-map-marker-alt"></i> Address Information</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="addressLine1">Address Line 1 *</label>
                            <input type="text" id="addressLine1" name="addressLine1" 
                                   value="<%= company && company.address ? company.address.line1 : '218/4B, Checkanurani' %>" 
                                   required>
                            <small class="form-help">Street address, P.O. Box, company name</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="addressLine2">Address Line 2</label>
                            <input type="text" id="addressLine2" name="addressLine2" 
                                   value="<%= company && company.address ? company.address.line2 : 'Madurai High Way, Arul Nagar, Uathupatti, Thirumanglam (T.K)' %>">
                            <small class="form-help">Apartment, suite, unit, building (optional)</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="city">City *</label>
                            <input type="text" id="city" name="city" 
                                   value="<%= company && company.address ? company.address.city : 'Chandigarh' %>" 
                                   required>
                        </div>
                        
                        <div class="form-group">
                            <label for="state">State *</label>
                            <select id="state" name="state" required>
                                <option value="">Select State</option>
                                <option value="Punjab" <%= company && company.address && company.address.state === 'Punjab' ? 'selected' : '' %>>Punjab</option>
                                <option value="Maharashtra" <%= company && company.address && company.address.state === 'Maharashtra' ? 'selected' : '' %>>Maharashtra</option>
                                <option value="Gujarat" <%= company && company.address && company.address.state === 'Gujarat' ? 'selected' : '' %>>Gujarat</option>
                                <option value="Karnataka" <%= company && company.address && company.address.state === 'Karnataka' ? 'selected' : '' %>>Karnataka</option>
                                <option value="Tamil Nadu" <%= company && company.address && company.address.state === 'Tamil Nadu' ? 'selected' : '' %>>Tamil Nadu</option>
                                <option value="Andhra Pradesh" <%= company && company.address && company.address.state === 'Andhra Pradesh' ? 'selected' : '' %>>Andhra Pradesh</option>
                                <option value="Telangana" <%= company && company.address && company.address.state === 'Telangana' ? 'selected' : '' %>>Telangana</option>
                                <option value="Rajasthan" <%= company && company.address && company.address.state === 'Rajasthan' ? 'selected' : '' %>>Rajasthan</option>
                                <option value="Haryana" <%= company && company.address && company.address.state === 'Haryana' ? 'selected' : '' %>>Haryana</option>
                                <option value="Uttar Pradesh" <%= company && company.address && company.address.state === 'Uttar Pradesh' ? 'selected' : '' %>>Uttar Pradesh</option>
                                <option value="West Bengal" <%= company && company.address && company.address.state === 'West Bengal' ? 'selected' : '' %>>West Bengal</option>
                                <option value="Odisha" <%= company && company.address && company.address.state === 'Odisha' ? 'selected' : '' %>>Odisha</option>
                                <option value="Kerala" <%= company && company.address && company.address.state === 'Kerala' ? 'selected' : '' %>>Kerala</option>
                                <option value="Madhya Pradesh" <%= company && company.address && company.address.state === 'Madhya Pradesh' ? 'selected' : '' %>>Madhya Pradesh</option>
                                <option value="Chhattisgarh" <%= company && company.address && company.address.state === 'Chhattisgarh' ? 'selected' : '' %>>Chhattisgarh</option>
                                <option value="Delhi" <%= company && company.address && company.address.state === 'Delhi' ? 'selected' : '' %>>Delhi</option>
                                <option value="Chandigarh" <%= company && company.address && company.address.state === 'Chandigarh' ? 'selected' : '' %>>Chandigarh</option>
                                <option value="Himachal Pradesh" <%= company && company.address && company.address.state === 'Himachal Pradesh' ? 'selected' : '' %>>Himachal Pradesh</option>
                                <option value="Jammu and Kashmir" <%= company && company.address && company.address.state === 'Jammu and Kashmir' ? 'selected' : '' %>>Jammu and Kashmir</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="pincode">PIN Code *</label>
                            <input type="text" id="pincode" name="pincode" 
                                   value="<%= company && company.address ? company.address.pincode : '160002' %>" 
                                   pattern="[0-9]{6}" maxlength="6" required>
                            <small class="form-help">6-digit postal code</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="country">Country</label>
                            <input type="text" id="country" name="country" 
                                   value="<%= company && company.address ? company.address.country : 'India' %>" 
                                   readonly>
                        </div>
                    </div>
                </div>

                <!-- Legal & Tax Information -->
                <div class="form-section">
                    <h3><i class="fas fa-file-contract"></i> Legal & Tax Information</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="gstin">GSTIN Number</label>
                            <input type="text" id="gstin" name="gstin" 
                                   value="<%= company && company.gst ? company.gst.gstin : '33EEOPR7876R1ZZ' %>" 
                                   pattern="[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}" 
                                   maxlength="15" placeholder="33EEOPR7876R1ZZ">
                            <small class="form-help">15-character GST identification number</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="panNo">PAN Number</label>
                            <input type="text" id="panNo" name="panNo" 
                                   value="<%= company && company.gst ? company.gst.panNo : 'ABCDE1234F' %>" 
                                   pattern="[A-Z]{5}[0-9]{4}[A-Z]{1}" 
                                   maxlength="10" placeholder="ABCDE1234F">
                            <small class="form-help">10-character PAN number</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="registrationDate">GST Registration Date</label>
                            <input type="date" id="registrationDate" name="registrationDate" 
                                   value="<%= company && company.gst ? company.gst.registrationDate : '' %>">
                            <small class="form-help">Date of GST registration</small>
                        </div>
                    </div>
                </div>

                <!-- Invoice Settings -->
                <div class="form-section">
                    <h3><i class="fas fa-file-invoice"></i> Invoice Settings</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="invoicePrefix">Invoice Prefix</label>
                            <input type="text" id="invoicePrefix" name="invoicePrefix" 
                                   value="<%= company && company.invoice ? company.invoice.prefix : 'VS-' %>" 
                                   placeholder="VS-">
                            <small class="form-help">Prefix for invoice numbers (e.g., VS-)</small>
                        </div>
                    </div>
                </div>


                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Company Settings
                    </button>
                    <a href="/dashboard" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Cancel
                    </a>
                    <button type="button" class="btn btn-warning" onclick="resetForm()">
                        <i class="fas fa-undo"></i> Reset Form
                    </button>
                </div>
            </form>
        </div>
    </main>

    <!-- Footer -->
    <footer class="main-footer">
        <p>&copy; 2025 <%= companyName %>. Company Settings Configuration</p>
    </footer>

    <script>
        // Auto-hide alerts
        document.addEventListener('DOMContentLoaded', function() {
            const alerts = document.querySelectorAll('.alert');
            alerts.forEach(alert => {
                setTimeout(() => {
                    alert.style.opacity = '0';
                    setTimeout(() => alert.remove(), 300);
                }, 5000);
            });
        });

        // Reset form function
        function resetForm() {
            if (confirm('Are you sure you want to reset all changes?')) {
                document.querySelector('form').reset();
            }
        }

        // Auto-format GSTIN
        document.getElementById('gstin').addEventListener('input', function(e) {
            const value = e.target.value.toUpperCase();
            e.target.value = value;
        });

        // Auto-format PAN
        document.getElementById('panNo').addEventListener('input', function(e) {
            const value = e.target.value.toUpperCase();
            e.target.value = value;
        });

        // Auto-format pincode
        document.getElementById('pincode').addEventListener('input', function(e) {
            const value = e.target.value.replace(/\D/g, '');
            e.target.value = value;
        });
    </script>
</body>
</html>
